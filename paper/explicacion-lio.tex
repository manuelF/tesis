El software que servirá como caso de estudio para este trabajo es un software de 
din\'amica molecular denominado LIO. Este software ha sido objeto de otros 
trabajos de investigación~\cite{PaperNitscheManu}~\cite{TesisNitsche} y ha sido 
usado en trabajos de simulaci\'on en din\'amica molecular.

A continuaci\'on presentaremos un breve res\'umen de los aspectos te\'oricos detr\'as de
la herramienta, de manera de servir de base para entender las distintas partes optimizadas
del mismo.

El prop\'osito de este \textit{software} es realizar simulaciones de las propiedaes
de sistemas qu\'imicos complejos (solutos en soluci\'on, prote\'inas, etc.). Estas
propiedades est\'an estudiadas dentro del marco te\'orico de la mec\'anica cu\'antica
modelando el sistema como un conjunto de part\'iculas.

En principio todas las propiedades de un sistema de part\'iculas livianas
(como los electr\'ones) pueden ser obtenidas a partir de la funci\'on de onda $\Psi$,
la cual obedece la ecuaci\'on de onda de Schr\"odinger \textit{dependiente del tiempo},

\begin{equation}
    \label{schro_time_dep}
    -\hbar\frac{\partial \Psi}{\partial t} (\mathbf{r},t) = \frac{-\hbar^2}{2\mu}\nabla^2 \Psi(\mathbf{r},t) + V(\mathbf{r},t) \Psi(\mathbf{r},t)
\end{equation}

donde $\mathbf{r} = (r_1,\dots,r_n)$ es el vector de todas las posiciones de las part\'iculas del sistema,
$m$ es la masa de una part\'icula cualquiera, $V$ es un campo externo que afecta a las part\'iculas y
$\hbar$ es la constante de Planck divida por $2\pi$. En esta versi\'on, el campo $V$ depende del tiempo; si
esto no ocurre se puede simplificar utilizando el operador Hamiltoniano

\begin{equation*}
    \hat{H} =  -\frac{\hbar^2}{m} \nabla^2 + \hat{V}
\end{equation*}

a la ecuaci\'on de Sch\"odinger \textit{independiente del tiempo}

\begin{equation}
    \label{schro_time_indep}
    \hat{H} \Psi(\mathbf{r}) = E \Psi(\mathbf{r})
\end{equation}

Donde $E$ es la energ\'ia asociada a la funci\'on de onda $\Psi$.

Ahora, resolver esta ecuaci\'on diferencial no se puede hacer de manera exacta para sistemas que involucran m\'as
de una part\'icula, por lo cual se utilizan m\'etodos aproximados. Estos m\'etodos son computacionalmente muy caros
(del \'orden c\'ubico o mayor) por lo cual otro enfoque es necesario para resolver el problema.

El enfoque de LIO esta dentro del marco de t\'ecnicas de simulaci\'on h\'ibrida denominadas QM/MM 
(\textit{Quantum Mechanical}/\textit{Molecular Mechanical}). Este enfoque consiste en resolver la ecuaci\'on de
Schr\"odinger en la porci\'on activa del sistema (por ejemplo el soluto) y modelar el resto (el solvente por
ejemplo) mediante din\'amica cl\'asica. De esta manera se obtiene, con un costo moderado, el comportamiento de
la porci\'on activa modulado por el comportamiento del resto del sistema.

Para resolver num\'ericamente~\ref{schro_time_indep} en la porci\'on activa del sistema se utiliza el m\'etodo
de DFT (\textit{Density Functional Theory}). La base de este m\'etodo consiste en la introducci\'on de la
\textit{densidad electr\'onica} $\rho$, que viene a representar la probabilidad de encontrar un electr\'on en
el espacio dado un estado de la configuraci\'on del sistema. $\rho$ y $\Psi$ (y por lo tanto $E$) se encuentran relacionadas por

\begin{equation}
    \label{honenberg_kohn}
    \rho(\vec{r}_i) = \int \Psi^{\dagger}(\vec{r}_1, \dots, \vec{r}_n) \Psi(\vec{r}_1, \dots, \vec{r}_n) d\vec{r}_1 \dots d\vec{r}_n \qquad i \in [1,n]
\end{equation}

Donde $\Psi^{\dagger}$ es el conjugado de $\Psi$. La energ\'ia entonces es un \textit{funcional} de la densidad, $E[\rho]$. Otros trabajos de DFT dan m\'as
detalles a esta relaci\'on~\cite{HohenbergKohn}. Uno de los principales resultados de DFT es la siguiente ecuaci\'on para la relaci\'on entre $E$ y $\rho$:

\begin{equation}
    \label{honenberg_kohn} 
    E[\rho] = T_s[\rho] + V_{ne}[\rho] + \frac{1}{2} \int \int \frac{\rho(\vec{r}_1) \rho(\vec{r}_2)}{r_{12}} d\vec{r}_1 d\vec{r_2} + E_{xc}[\rho]
\end{equation}

Donde $T_s[\rho]$ es la energ\'ia cin\'etica asociada con la densidad, $V_{ne}[\rho]$ es la energ\'ia potencial producto de la interacci\'on entre los
electr\'ones (la densidad) y los n\'ucleos, el tercer t\'ermino es el resultado de la repulsi\'on de Coulomb entre electrones y $E_{xc}[\rho]$ es la
energ\'ia de intercambio y correlacci\'on.

Para este trabajo, debido a su costo computacional~\cite{PaperNitscheManu}, nos interesar\'a sobre todo el computo de la energ\'ia de intercambio y correlacci\'on ($E_{xc}$).
Esta energ\'ia es calculada mediante 

\begin{equation}
    E_{XC} = \int \rho(r) \epsilon_{xc}\left( \rho(r) \right ) dr
\end{equation}

que es integrada n\'umericamente en una grilla (cuya forma definiremos posteriormente y por ahora ser\'a asumida como dada), mediante la suma

\begin{equation}
    \label{approx_excenergy}
    E_{XC} \approx \sum_j \rho(r_j) \epsilon_{xc} (\rho(r_j))
\end{equation}

El t\'ermino $\epsilon_{xc}$ corresponde a un \textit{funcional de intercambio y correlaci\'on} que depende de la densidad local y
se aproxima (utilizando un concepto denominado \textit{Local density approximation}) a la energ\'ia de intercambio y correlaci\'on de 
un gas de electrones de la misma densidad:

\begin{equation}
    \epsilon_{xc}(\rho(\vec{r})) = -\frac{3}{4} \left (\frac{3 \rho(\vec{r})}{\phi} \right )^{\frac{1}{3}} + \epsilon_{C}(\rho(\vec{r}))
\end{equation}

Para el t\'ermino $\epsilon_{C}$ se conocen buenas aproximaciones num\'ericas~\cite{Vosko}.

Tenemos entonces que para calcular~\ref{approx_excenergy} es necesario conocer el valor de la densidad en la grilla.
El m\'etodo utilizado en este trabajo para realizar este calculo se conoce como m\'etodo de \textit{Kohn-Sham}. En primera instancia
se relaciona la densidad electr\'onica con los orbitales mediante la ecuaci\'on

\begin{equation}
    \rho(\vec{r}) = \sum_{i = 1}^{N_{oc}} \mid \phi_i(\vec{r}) \mid ^2
\end{equation}

con $N_{oc}$ la cantidad de orbitales ocupados por al menos un electr\'on. Los orbitales $\phi$ se construyen expandi\'endolos en una
base de contracciones $\{ \chi_1, \dots, \chi_n \}$:

\begin{equation}
    \phi_i(x,y,z) = \sum_{k = 1}^n C_{ik} \chi_k
\end{equation}

que tienen la forma de funciones gaussianas:

\begin{equation}
    \chi_k = (x - x_0)^{n_x^k} (y - y_0)^{n_y^k} (z - z_0)^{n_z^k} \sum_j k_j^k e^{-\alpha_j \|(x,y,z) - (x_0,y_0,z_0) \|^2 }
\end{equation}

Resta entonces definir la grilla de integraci\'on y como se determina la matriz de coeficientes $C$. 

La grilla de integraci\'on consiste de dos partes: los puntos en si y los pesos de integraci\'on asignados a cada punto. En este
\textit{software} los puntos se eligen a partir de capas conc\'entricas centradas en los \'atomos del sistema, de la siguiente
manera:

\begin{align}
    \vec{r} & = \vec{s}_j \lambda_i + \vec{a} \\
    \lambda_i & = r_m \left ( \frac{1 + x_i}{1 - x_i} \right), i \in [1, k] \\
    x_i & = cos \left ( \frac{\pi i }{k + 1} \right )
\end{align}

Donde $\vec{s}_j$ es un punto de una grilla base definida por Lebedev en sus estudios de 1975~\cite{Lebedev1} y 1976~\cite{Lebedev2},
$k$ es la cantidad de capas y $r_m$ es la mitad del \textit{Radio de Slater}. Estos dos \'ultimos par\'ametros dependen del elemento qu\'imico
estudiado.

Los pesos son elegidos de acuerdo al m\'etodo de Becke~\cite{Becke}, que divide los
pesos $\omega_i$ en una serie $\omega_g'$d de pesos fijos y una serie $p_k$,

\begin{align}
    p_k(\vec{r}_{k,g}) & = \frac{w_k(\vec{r}_{k,g})}{\sum_j^K w_j(\vec{r}_{j,g})} \\
    w_k(\vec{r}_{k,g}) & = \prod_{i \neq k}^K s(\mu_{ki}) \\
    \mu_{ki} & = \frac{\mid \vec{a}_k - \vec{r}_{k,g} \mid - \mid \vec{a}_i - \vec{r}_{i,g} \mid }{ \mid \vec{a}_k - \vec{a}_i \mid }
\end{align}

donde $w_k(\vec{r}_k,g)$ corresponde al peso parcial del punto $g$ perteneciente al
\'atomo $k$ cuya posici\'on es $\vec{a}_k$, y $K$ es la cantidad de \'atomos del
sistema. $s$ es un polinomio dentro del rango $[0,1]$.

Estos pesos no solo se utilizan para la grilla sino tambi\'en para definir el m\'etodo
iterativo con el que se calcula la matriz de coeficientes $C$.

Esta matriz se determina indirectamente mediante la matriz de \textit{Kohn-Sham}. La
relaci\'on entre esta matriz $\Gamma$ y $C$ se determina indirectamente usando $\rho$
y un conjunto de ecuaciones denominadas \textit{Ecuaciones de Roothaan}:

\begin{align}
    \label{roothaan}
    \Gamma_{ij/ i < j} & = \sum_{k,g} \Gamma'_{ij}(k,g) \\
    \Gamma'_{ij} (k,g) & = \phi_i (\vec{r}_{k,g}) \phi_j (\vec{r}_{k,g}) p_k(\vec{r}_{k,g}) \omega'_g y \\
    y & = f(\epsilon_{xc}(\rho(\vec{r}_{k,g}))) 
\end{align}

Inicialmente se toma un valor de $C$ aproximado y luego se repiten varias iteraciones
del sistema~\ref{roothaan} hasta lograr minimizar la energ\'ia $E[\rho]$ asociada
a la densidad. Por el \textit{Teorema de Variaci\'on de Hohenberg y Kohn}, cuando
estas iteraciones convergen se tiene la mejor aproximaci\'on posible para la
densidad $\rho$ y su energ\'ia $E[\rho]$.

Esto describe a grandes rasgos los c\'alculos realizados por la secci\'on m\'as
intensiva computacionalmente. Existen varias optimizaciones, por ejemplo el uso de
puntos de corte (\textit{cutoff}) de funciones de manera que las funciones de la
base Gaussiana que tienen un valor negligible en ciertos puntos de la grilla no
sean calculadas en esos lugares, como esta descripto en~\cite{PaperNitscheManu}.
