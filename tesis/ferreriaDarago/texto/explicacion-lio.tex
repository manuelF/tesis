Con la aparici\'on de las computadoras en el \'ambito de la ciencias experimentales, han
ganado tracci\'on los desarrollos en m\'etodos de simulaci\'on de modelos matem\'aticos. 
Con el apoyo de estas nuevas t\'ecnicas se hace posible no solo
complementar la experimentaci\'on sino tambi\'en explorar la teor\'ia de fondo de maneras que
no son posibles o convenientes mediante enfoques m\'as cl\'asicos.

Un ejemplo es el estudio, dentro del marco de la qu\'imica, de los comportamientos de las 
part\'iculas peque\~nas (electrones, protones, etc.) de acuerdo a las leyes de la f\'isica. En este \'area las
simulaciones de los postulados que rigen la mec\'anica de part\'iculas (denominada mec\'anica cu\'antica)
resultan invaluables para el estudio de fen\'omenos a escala microsc\'opica.

La mec\'anica cu\'antica establece que todas las propiedades de un sistema de part\'iculas peque\~nas
pueden ser obtenidas a partir de la funci\'on de onda $\Psi$ del mismo, la cual obedece la 
ecuaci\'on de onda de Schr\"odinger \textit{dependiente del tiempo},

\begin{equation}
    \label{schro_time_dep}
    -\hbar\frac{\partial \Psi}{\partial t} (\mathbf{r},t) = \frac{-\hbar^2}{2\mu}\nabla^2 \Psi(\mathbf{r},t) + V(\mathbf{r},t) \Psi(\mathbf{r},t)
\end{equation}

donde $\mathbf{r} = (r_1,\dots,r_n)$ es el vector de todas las posiciones de las part\'iculas del sistema,
$m$ es la masa de una part\'icula cualquiera, $V$ es un campo externo que afecta a las part\'iculas y
$\hbar$ es la constante de Planck divida por $2\pi$. En esta versi\'on, el campo $V$ depende del tiempo; si
esto no ocurre se puede simplificar utilizando el operador Hamiltoniano

\begin{equation*}
    \hat{H} =  -\frac{\hbar^2}{m} \nabla^2 + \hat{V}
\end{equation*}

a la ecuaci\'on de Sch\"odinger \textit{independiente del tiempo}

\begin{equation}
    \label{schro_time_indep}
    \hat{H} \Psi(\mathbf{r}) = E \Psi(\mathbf{r})
\end{equation}

Donde $E$ es la energ\'ia asociada a la funci\'on de onda $\Psi$.

Ahora, si bien resolver esta ecuaci\'on diferencial ser\'ia suficiente para determinar todas las propiedades del sistema, esto no puede hacerse de 
manera exacta cuando hay m\'as de una part\'icula en el mismo. Por este motivo, para problemas de mayor tama\~no se utilizan aproximaciones num\'ericas
para obtener una soluci\'on de~\ref{schro_time_indep}.

Existen diversos m\'etodos aproximados para resolver esta ecuaci\'on, los cuales intercambian costo computacional (es decir, cantidad de operaciones a realizar)
por precisi\'on de la respuesta obtanida. Debido a su buena relaci\'on costo/calidad, para resolver numericamente~\ref{schro_time_indep}, utilizamos el modelo propuesto por la
DFT (\textit{Density Functional Theory}). 

La base de este m\'etodo consiste en dos teoremas publicados por Hohenberg y Kohn en 1964~\cite{HohenbergKohn}. El primero introduce el concepto de la \textit{densidad electr\'onica} $\rho$, que viene a representar la probabilidad de encontrar un electr\'on en
el espacio dado un estado de la configuraci\'on del sistema. El resultado te\'orico que provee el primer teorema es entonces que 
$\rho$ y $\Psi$ (y por lo tanto $E$) se encuentran relacionadas por la siguiente ecuaci\'on:

\begin{equation}
    \label{hohenberg_kohn}
    \rho(\vec{r}_i) = \int \Psi^{\dagger}(\vec{r}_1, \dots, \vec{r}_n) \Psi(\vec{r}_1, \dots, \vec{r}_n) d\vec{r}_1 \dots d\vec{r}_n \qquad i \in [1,n]
\end{equation}

Donde $\Psi^{\dagger}$ es el conjugado de $\Psi$. La energ\'ia entonces es un \textit{funcional} de la densidad, $E[\rho]$. 
La siguiente ecuaci\'on rige la relaci\'on entre $E$ y $\rho$:

\begin{equation}
    \label{hohenberg_kohn_energy} 
    E[\rho] = T_s[\rho] + V_{ne}[\rho] + \frac{1}{2} \int \int \frac{\rho(\vec{r}_1) \rho(\vec{r}_2)}{r_{12}} d\vec{r}_1 d\vec{r_2} + E_{xc}[\rho]
\end{equation}

Donde $T_s[\rho]$ es la energ\'ia cin\'etica asociada con la densidad, $V_{ne}[\rho]$ es la energ\'ia potencial producto de la interacci\'on entre los
electr\'ones (la densidad) y los n\'ucleos, el tercer t\'ermino es el resultado de la repulsi\'on de Coulomb entre electrones y $E_{xc}[\rho]$ es la
energ\'ia de intercambio y correlacci\'on.

Para este trabajo, debido a su costo computacional~\cite{PaperNitscheManu}, nos interesar\'a sobre todo el computo de la energ\'ia de intercambio y correlacci\'on ($E_{xc}$).
Esta energ\'ia se define matem\'aticamente mediante

\begin{equation}
    E_{XC} = \int \rho(r) \epsilon_{xc}\left( \rho(r) \right ) dr
\end{equation}

y es aproximada mediante una integral n\'umerica utilizando una grilla de puntos con peso.

\begin{equation}
    \label{approx_excenergy}
    E_{XC} \approx \sum_j \rho(r_j) \epsilon_{xc} (\rho(r_j))
\end{equation}

Este valor puede aproximarse de diversas maneras, con distintos resultados num\'ericos y cantidad de operaciones
asociado, debido a que para el c\'alculo del t\'ermino $E_{XC}$ se puede considerar el gradiente
y el hessiano de la energ\'ia de intercambio y correlaci\'on (necesitando entonces calcular
estos valores para cada punto). 

Otro aspecto importante de esta teor\'ia es que provee una manera de calcular la densidad $\rho$,
mediante el denominado m\'etodo de Kohn-Sham~\cite{KohnSham}. Este m\'etodo se basa en el segundo teorema
de Hohenberg y Khon, que establece que la densidad electr\'onica es la funci\'on que
cumple que $\int \rho(r) dr = N$, la cantidad de atomos del sistema, $\rho(r) \geq 0$ y que
minimiza la energ\'ia $E[\rho]$~\ref{hohenberg_kohn_energy}. Esto nos da
un m\'etodo iterativo para, empezando con una aproximaci\'on inicial a la densidad electr\'onica,
iterar el calculo de la misma (usando una matriz de coeficientes denominada \textit{Matriz de Kohn Sham}), hasta
alcanzar un m\'inimo para $E$.

El algoritmo que se deduce de la DFT es uno de los m\'etodos m\'as populares en c\'alculos
de estado s\'olido, especialmente desde la decada del 90 cuando se mejor\'o las aproximaciones para modelado de
interacciones. El valor de esta teor\'ia para el estudio de las propiedades de la materia le vali\'o a Kohn el Premio Nobel
de Qu\'imica en 1998.

Si bien la relaci\'on costo calidad de este m\'etodo es muy buena, ya que la aproximaci\'on escala de manera lineal 
en cantidad de \'atomos, para sistemas de inter\'es (como por ejemplo soluto en solvente) sigue siendo inviable. Los
modelos basados en f\'isica cl\'asica pueden aproximar bien el comportamiento cuando no ocurre la creaci\'on y ruptura
de enlaces covalentes, con lo cual cuando ocurren reacciones qu\'imicas no es posible usarlos ya que no proveen un
detalle electr\'onico. 

Para resolver esto, en este trabajo se utiliza DFT dentro de un modelo h\'ibrido QM/MM (\textit{Quantum Mechanical / Molecular Mechanical}). 
En este modelo, se resuelve la ecuaci\'on~\ref{schro_time_indep} en la parte reactiva del sistema (donde la estructura
electr\'onica cambia), modulando este comportamiento mediante una simulaci\'on basada en din\'amica
cl\'asica del resto del sistema. Para esto se divide la energ\'ia en tres partes:

\begin{equation}
    E = E_{QM} + E_{QM-MM} + E_{MM}
\end{equation}

Donde la energ\'ia $E_{QM}$ se obtiene mediante el m\'etodo DFT visto m\'as arriba, y la energ\'ia
$E_{MM}$ proviene de simular el campo de fuerzas cl\'asico de atracci\'on electroest\'atica de
Coulomb (por ejemplo usando \textit{n-body}).

La contribuci\'on $E_{QM-MM}$ en este trabajo, se calcula mediante la ecuaci\'on

\begin{equation}
    E_{QM-MM} = \sum_{l = 1}^{N_c} q_l \int \frac{\rho(r)}{\mid r - R_l \mid} + \sum_{l = 1}^{N_c}\sum_{\alpha = 1}^{N_q} [ v_{LJ} ( \mid R_l - \tau_\alpha \mid ) + \frac{q_l z_\alpha}{\mid R_l - \tau_\alpha \mid} ]
\end{equation}

Donde el primer t\'ermino relaciona una carga puntual del sistema cl\'asico con la densidad
elect\'onica, y el segundo t\'ermino representa la interacci\'on entre los n\'ucleos cl\'asicos
con los cu\'anticos mediante un potencial de Lennard-Jones y la interacci\'on Coulombica entre
las cargas.

Los m\'etodos \textit{QM/MM}, dentro del marco de m\'etodos multiescala, son ampliamente utilizados en
la pr\'actica. Estos modelos multiescala han valido a Karplus, Levitt y
Warshel el premio Nobel de Qu\'imica en 2013, por su valor para la simulaci\'on de sistemas complejos.

Nuestro trabajo se realiza en base a programas ya existentes. El c\'alculo de $E_{QM}$ y $E_{QM-MM}$ son realizados por el paquete de \textit{software} LIO~\cite{PaperNitscheManu}~\cite{TesisNitsche}, el cual fue optimizado para este trabajo para el uso de distintas arquitecturas de CPU y GPGPU. Esta librer\'ia
se complementa mediante el uso del programa de din\'amica molecular Amber~\cite{Amber}, que realiza el calculo
de $E_{MM}$. Nos concentraremos en las partes m\'as intensivas computacionalmente de LIO, que corresponden a la
implementaci\'on de los c\'alculos que hemos introducido en esta secci\'on.
