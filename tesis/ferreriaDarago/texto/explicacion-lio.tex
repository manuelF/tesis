Con la aparici\'on de las computadoras en el \'ambito de la ciencias experimentales, han
ganado tracci\'on los desarrollos en m\'etodos de simulaci\'on como manera de exploraci\'on
de modelos matem\'aticos. Con el apoyo de estas nuevas t\'ecnicas se hace posible no solo
complementar la experimentaci\'on sino tambi\'en explorarla teor\'ia de fondo de maneras que
no son posibles o convenientes mediante enfoques m\'as cl\'asicos. 

Un ejemplo es el estudio, dentro del marco de la qu\'imica, de los comportamientos de las 
part\'iculas peque\~nas (como por ejemplo los electrones) predichos por la f\'isica. En este \'area las
simulaciones de los postulados que rigen la mec\'anica de part\'iculas (denominada mec\'anica cu\'antica)
resultan invaluables para el estudio de fen\'omenos a escala microsc\'opica.

La mec\'anica cu\'antica establece que todas las propiedades de un sistema de part\'iculas peque\~nas
pueden ser obtenidas a partir de la funci\'on de onda $\Psi$ del mismo, la cual obedece la 
ecuaci\'on de onda de Schr\"odinger \textit{dependiente del tiempo},

\begin{equation}
    \label{schro_time_dep}
    -\hbar\frac{\partial \Psi}{\partial t} (\mathbf{r},t) = \frac{-\hbar^2}{2\mu}\nabla^2 \Psi(\mathbf{r},t) + V(\mathbf{r},t) \Psi(\mathbf{r},t)
\end{equation}

donde $\mathbf{r} = (r_1,\dots,r_n)$ es el vector de todas las posiciones de las part\'iculas del sistema,
$m$ es la masa de una part\'icula cualquiera, $V$ es un campo externo que afecta a las part\'iculas y
$\hbar$ es la constante de Planck divida por $2\pi$. En esta versi\'on, el campo $V$ depende del tiempo; si
esto no ocurre se puede simplificar utilizando el operador Hamiltoniano

\begin{equation*}
    \hat{H} =  -\frac{\hbar^2}{m} \nabla^2 + \hat{V}
\end{equation*}

a la ecuaci\'on de Sch\"odinger \textit{independiente del tiempo}

\begin{equation}
    \label{schro_time_indep}
    \hat{H} \Psi(\mathbf{r}) = E \Psi(\mathbf{r})
\end{equation}

Donde $E$ es la energ\'ia asociada a la funci\'on de onda $\Psi$.

Ahora, si bien resolver esta ecuaci\'on diferencial ser\'ia suficiente para determinar todas las propiedades del sistema, esto no puede hacerse de 
manera exacta cuando hay m\'as de una part\'icula en el mismo. Por este motivo, para problemas de mayor tama\~no se utilizan aproximaciones de las
ecuaciones de la mec\'anica cu\'antica.

Estos m\'etodos son computacionalmente muy caros (del \'orden c\'ubico o mayor) con lo cual son impr\'acticos para n\'umeros de part\'iculas de 
tama\~no incluso mediano. La alternativa de utilizar aproximaciones basadas en los postulados de la mec\'anica cl\'asica no modela correctamente el
comportamiento de electrones cuando su distribuci\'on es din\'amica, como ocurre en las reacciones qu\'imicas. Por esto, otro enfoque es necesario 
para resolver el problema en sistemas cuyo tama\~no hace estos m\'etodos inviables (como lo es por ejemplo un soluto en soluci\'on).

Uno de esto enfoques, y el utilizado en este trabajo, esta dentro de las t\'ecnicas de simulaci\'on h\'ibrida denominadas QM/MM 
(\textit{Quantum Mechanical}/\textit{Molecular Mechanical}). Este enfoque consiste en resolver la ecuaci\'on de
Schr\"odinger en una porci\'on del sistema donde se producen las reacciones que requieren detalle electr\'onico (por ejemplo el soluto), 
y modelar el resto (el solvente por ejemplo) mediante un campo de fuerzas cl\'asico. De esta manera se obtiene, con un costo moderado, 
el comportamiento de la parte reactiva del sistema, modulado por el comportamiento del resto del mismo.

La base de este m\'etodo consiste en dividir la energ\'ia del sistema en tres partes:

\begin{equation}
    \label{qmmm-eq}
    E = E_{QM} + E_{QM-MM} + E_{MM} 
\end{equation}

Donde $E_{QM}$ corresponde a la energ\'ia de del subsistema cu\'antico (modelada mediante los m\'etodos se\~nalados arriba) donde la estructura
electr\'onica cambia mucho, $E_{MM}$ es la parte modelada mediante mec\'anica cl\'asica (utilizando simulaciones de \textit{n-body} de los campos de
fuerza cl\'asicos). La principal para esta tesis (debido a su costo computacional) es $E_{QM}$, la cual detallamos a continuaci\'on.

Para resolver las aproximaciones de $E_{QM}$, se utilizar\'a en el este trabajo el modelo propuesto por la
DFT (\textit{Density Functional Theory}), especialmente en base a dos teoremas publicados por Hohenberg y Kohn en 1964. La base de este m\'etodo consiste en la introducci\'on de la
\textit{densidad electr\'onica} $\rho$, que viene a representar la probabilidad de encontrar un electr\'on en
el espacio dado un estado de la configuraci\'on del sistema en el estado de menor energ\'ia del sistema. Uno de los principales resultados te\'oricos que dan base a DFT es que 
$\rho$ y $\Psi$ (y por lo tanto $E$) se encuentran relacionadas por

\begin{equation}
    \label{honenberg_kohn}
    \rho(\vec{r}_i) = \int \Psi^{\dagger}(\vec{r}_1, \dots, \vec{r}_n) \Psi(\vec{r}_1, \dots, \vec{r}_n) d\vec{r}_1 \dots d\vec{r}_n \qquad i \in [1,n]
\end{equation}

Donde $\Psi^{\dagger}$ es el conjugado de $\Psi$. La energ\'ia entonces es un \textit{funcional} de la densidad, $E[\rho]$. Los detalles de esta relaci\'on se encuentran
en~\cite{HohenbergKohn}. Uno de los principales resultados de DFT es la siguiente ecuaci\'on para la relaci\'on entre $E$ y $\rho$:

\begin{equation}
    \label{honenberg_kohn} 
    E[\rho] = T_s[\rho] + V_{ne}[\rho] + \frac{1}{2} \int \int \frac{\rho(\vec{r}_1) \rho(\vec{r}_2)}{r_{12}} d\vec{r}_1 d\vec{r_2} + E_{xc}[\rho]
\end{equation}

Donde $T_s[\rho]$ es la energ\'ia cin\'etica asociada con la densidad, $V_{ne}[\rho]$ es la energ\'ia potencial producto de la interacci\'on entre los
electr\'ones (la densidad) y los n\'ucleos, el tercer t\'ermino es el resultado de la repulsi\'on de Coulomb entre electrones y $E_{xc}[\rho]$ es la
energ\'ia de intercambio y correlacci\'on.

Para este trabajo, debido a su costo computacional~\cite{PaperNitscheManu}, nos interesar\'a sobre todo el computo de la energ\'ia de intercambio y correlacci\'on ($E_{xc}$).
Esta energ\'ia es calculada mediante 

\begin{equation}
    E_{XC} = \int \rho(r) \epsilon_{xc}\left( \rho(r) \right ) dr
\end{equation}

que es integrada n\'umericamente en una grilla (cuya forma definiremos posteriormente y por ahora ser\'a asumida como dada), mediante la suma

\begin{equation}
    \label{approx_excenergy}
    E_{XC} \approx \sum_j \rho(r_j) \epsilon_{xc} (\rho(r_j))
\end{equation}

El t\'ermino $\epsilon_{xc}$ corresponde a un \textit{funcional de intercambio y correlaci\'on} que depende de la densidad local y
se aproxima (utilizando un concepto denominado \textit{Local density approximation}) a la energ\'ia de intercambio y correlaci\'on de 
un gas de electrones de la misma densidad:

\begin{equation}
    \epsilon_{xc}(\rho(\vec{r})) = -\frac{3}{4} \left (\frac{3 \rho(\vec{r})}{\phi} \right )^{\frac{1}{3}} + \epsilon_{C}(\rho(\vec{r}))
\end{equation}

Para el t\'ermino $\epsilon_{C}$ se conocen buenas aproximaciones num\'ericas~\cite{Vosko}.

Tenemos entonces que para calcular~\ref{approx_excenergy} es necesario conocer el valor de la densidad en la grilla.
El m\'etodo utilizado en este trabajo para realizar este calculo se conoce como m\'etodo de \textit{Kohn-Sham}. En primera instancia
se relaciona la densidad electr\'onica con los orbitales mediante la ecuaci\'on

\begin{equation}
    \rho(\vec{r}) = \sum_{i = 1}^{N_{oc}} \mid \phi_i(\vec{r}) \mid ^2
\end{equation}

con $N_{oc}$ la cantidad de orbitales ocupados por al menos un electr\'on. Los orbitales $\phi$ se construyen expandi\'endolos en una
base de contracciones $\{ \chi_1, \dots, \chi_n \}$:

\begin{equation}
    \phi_i(x,y,z) = \sum_{k = 1}^n C_{ik} \chi_k
\end{equation}

que tienen la forma de funciones gaussianas:

\begin{equation}
    \chi_k = (x - x_0)^{n_x^k} (y - y_0)^{n_y^k} (z - z_0)^{n_z^k} \sum_j k_j^k e^{-\alpha_j \|(x,y,z) - (x_0,y_0,z_0) \|^2 }
\end{equation}

Resta entonces definir la grilla de integraci\'on y como se determina la matriz de coeficientes $C$. 

La grilla de integraci\'on consiste de dos partes: los puntos en si y los pesos de integraci\'on asignados a cada punto. Para el 
desarrollo posterior, los puntos se eligen a partir de capas conc\'entricas centradas en los \'atomos del sistema, de la siguiente
manera:

\begin{align}
    \vec{r} & = \vec{s}_j \lambda_i + \vec{a} \\
    \lambda_i & = r_m \left ( \frac{1 + x_i}{1 - x_i} \right), i \in [1, k] \\
    x_i & = cos \left ( \frac{\pi i }{k + 1} \right )
\end{align}

Donde $\vec{s}_j$ es un punto de una grilla base definida por Lebedev en sus estudios de 1975~\cite{Lebedev1} y 1976~\cite{Lebedev2},
$k$ es la cantidad de capas y $r_m$ es la mitad del \textit{Radio de Slater}. Estos dos \'ultimos par\'ametros dependen del elemento qu\'imico
estudiado.

Los pesos son elegidos de acuerdo al m\'etodo de Becke~\cite{Becke}, que divide los
pesos $\omega_i$ en una serie $\omega_g'$d de pesos fijos y una serie $p_k$,

\begin{align}
    p_k(\vec{r}_{k,g}) & = \frac{w_k(\vec{r}_{k,g})}{\sum_j^K w_j(\vec{r}_{j,g})} \\
    w_k(\vec{r}_{k,g}) & = \prod_{i \neq k}^K s(\mu_{ki}) \\
    \mu_{ki} & = \frac{\mid \vec{a}_k - \vec{r}_{k,g} \mid - \mid \vec{a}_i - \vec{r}_{i,g} \mid }{ \mid \vec{a}_k - \vec{a}_i \mid }
\end{align}

donde $w_k(\vec{r}_k,g)$ corresponde al peso parcial del punto $g$ perteneciente al
\'atomo $k$ cuya posici\'on es $\vec{a}_k$, y $K$ es la cantidad de \'atomos del
sistema. $s$ es un polinomio dentro del rango $[0,1]$.

Estos pesos no solo se utilizan para la grilla sino tambi\'en para definir el m\'etodo
iterativo con el que se calcula la matriz de coeficientes $C$.

Esta matriz se determina indirectamente mediante la matriz de \textit{Kohn-Sham}. La
relaci\'on entre esta matriz $\Gamma$ y $C$ se determina indirectamente usando $\rho$
y un conjunto de ecuaciones denominadas \textit{Ecuaciones de Roothaan}:

\begin{align}
    \label{roothaan}
    \Gamma_{ij/ i < j} & = \sum_{k,g} \Gamma'_{ij}(k,g) \\
    \Gamma'_{ij} (k,g) & = \phi_i (\vec{r}_{k,g}) \phi_j (\vec{r}_{k,g}) p_k(\vec{r}_{k,g}) \omega'_g y \\
    y & = f(\epsilon_{xc}(\rho(\vec{r}_{k,g}))) 
\end{align}

Inicialmente se toma un valor de $C$ aproximado y luego se repiten varias iteraciones
del sistema~\ref{roothaan} hasta lograr minimizar la energ\'ia $E[\rho]$ asociada
a la densidad. Por el \textit{Teorema de Variaci\'on de Hohenberg y Kohn}, cuando
estas iteraciones convergen se tiene la mejor aproximaci\'on posible para la
densidad $\rho$ y su energ\'ia $E[\rho]$.

Esto resume el c\'alculo de la energ\'ia $E_{QM}$ de la ecuaci\'on~\ref{qmmm-eq} utilizando DFT.
La contribuci\'on $E_{QM-MM}$ en este trabajo, se calcula mediante la ecuaci\'on

\begin{equation}
    E_{QM-MM} = \sum_{l = 1}^{N_c} q_l \int \frac{\rho(r)}{\mid r - R_l \mid} + \sum_{l = 1}^{N_c}\sum_{\alpha = 1}^{N_q} [ v_{LJ} ( \mid R_l - \tau_\alpha \mid ) + \frac{q_l z_\alpha}{\mid R_l - \tau_\alpha \mid} ]
\end{equation}

Donde el primer t\'ermino relaciona una carga puntual del sistema cl\'asico con la densidad
electÂ¶\'nica, y el segundo t\'ermino representa la interacci\'on entre los n\'ucleos cl\'asicos
con los cu\'anticos mediante un potencial de Lennard-Jones y la interacci\'on Coulombica entre
las cargas.

Por \'ultimo, para el t\'ermino $E_{MM}$ se utiliza modelos de soluci\'on basado en
agua denominados \texttt{TIP4P} y \texttt{TIP4P-FQ}. Estos modelos no ser\'an de inter\'es
para el desarrollo siguiente de nuestro trabajo, por lo cual referimos al lector a
referencias como \todo[author=JP]{Referencias a esto}.

La implementaci\'on de los c\'alculos previamente explicados para realizarse de manera
eficiente, explotando las ventajas de procesadores paralelos y vectoriales modernos, es
la base de este trabajo. Como base se tom\'o el paquete de computo de estructura electr\'onica
LIO. Trabajo previo realizado en este \textit{software} puede encontrarse en~\cite{PaperNitscheManu},
~\cite{TesisNitsche} utilizando trabajos previos de din\'amica molecular en DFT como~\cite{Yasuda}.
\todo[author=JP]{Agregar mas referencias}.
